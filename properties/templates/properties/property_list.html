<!DOCTYPE html>
<html>
<head>
    <title>Propiedades - Bienes Raíces</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        .filters {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f5f5f5;
            border-radius: 5px;
        }
        .properties-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        .property-card {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <h1>Listado de Propiedades</h1>
    
    <div class="filters">
        <h3>Filtros</h3>
        <form method="get">
            <div>
                <label for="property_type">Tipo de propiedad:</label>
                <select name="property_type" id="property_type">
                    <option value="">Todos</option>
                    <option value="casa" {% if property_type == 'casa' %}selected{% endif %}>Casa</option>
                    <option value="apartamento" {% if property_type == 'apartamento' %}selected{% endif %}>Apartamento</option>
                    <option value="oficina" {% if property_type == 'oficina' %}selected{% endif %}>Oficina</option>
                    <option value="local" {% if property_type == 'local' %}selected{% endif %}>Local Comercial</option>
                    <option value="terreno" {% if property_type == 'terreno' %}selected{% endif %}>Terreno</option>
                </select>
            </div>
            
            <div>
                <label for="operation_type">Tipo de operación:</label>
                <select name="operation_type" id="operation_type">
                    <option value="">Todos</option>
                    <option value="venta" {% if operation_type == 'venta' %}selected{% endif %}>Venta</option>
                    <option value="alquiler" {% if operation_type == 'alquiler' %}selected{% endif %}>Alquiler</option>
                    <option value="arrendamiento" {% if operation_type == 'arrendamiento' %}selected{% endif %}>Arrendamiento</option>
                </select>
            </div>
            
            <div>
                <label for="min_price">Precio mínimo:</label>
                <input type="number" name="min_price" id="min_price" value="{{ min_price }}">
                
                <label for="max_price">Precio máximo:</label>
                <input type="number" name="max_price" id="max_price" value="{{ max_price }}">
            </div>
            
            <div>
                <label for="sort">Ordenar por:</label>
                <select name="sort" id="sort">
                    <option value="">Relevancia</option>
                    <option value="price_asc" {% if sort_by == 'price_asc' %}selected{% endif %}>Precio (menor a mayor)</option>
                    <option value="price_desc" {% if sort_by == 'price_desc' %}selected{% endif %}>Precio (mayor a menor)</option>
                    <option value="newest" {% if sort_by == 'newest' %}selected{% endif %}>Más recientes</option>
                </select>
            </div>
            
            <button type="submit">Aplicar filtros</button>
        </form>
    </div>
    
    {% if properties %}
        <div class="properties-container">
            {% for property in properties %}
                <div class="property-card">
                    <h2>{{ property.title }}</h2>
                    <p>{{ property.description|truncatewords:20 }}</p>
                    <p><strong>Precio:</strong> ${{ property.price }}</p>
                    <p><strong>Ubicación:</strong> {{ property.location }}</p>
                    <p><strong>Tipo:</strong> {{ property.get_property_type_display }}</p>
                    <p><strong>Operación:</strong> {{ property.get_operation_type_display }}</p>
                    <a href="{% url 'properties:property_detail' property.id %}">Ver detalles</a>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No hay propiedades disponibles en este momento.</p>
    {% endif %}
</body>
</html>